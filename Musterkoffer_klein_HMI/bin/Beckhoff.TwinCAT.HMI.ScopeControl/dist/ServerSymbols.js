var __runInitializers=this&&this.__runInitializers||function(thisArg,initializers,value){for(var useValue=arguments.length>2,i=0;i<initializers.length;i++)value=useValue?initializers[i].call(thisArg,value):initializers[i].call(thisArg);return useValue?value:void 0},__esDecorate=this&&this.__esDecorate||function(ctor,descriptorIn,decorators,contextIn,initializers,extraInitializers){function accept(f){if(void 0!==f&&"function"!=typeof f)throw new TypeError("Function expected");return f}for(var _,kind=contextIn.kind,key="getter"===kind?"get":"setter"===kind?"set":"value",target=!descriptorIn&&ctor?contextIn.static?ctor:ctor.prototype:null,descriptor=descriptorIn||(target?Object.getOwnPropertyDescriptor(target,contextIn.name):{}),done=!1,i=decorators.length-1;i>=0;i--){var context={};for(var p in contextIn)context[p]="access"===p?{}:contextIn[p];for(var p in contextIn.access)context.access[p]=contextIn.access[p];context.addInitializer=function(f){if(done)throw new TypeError("Cannot add initializers after decoration has completed");extraInitializers.push(accept(f||null))};var result=(0,decorators[i])("accessor"===kind?{get:descriptor.get,set:descriptor.set}:descriptor[key],context);if("accessor"===kind){if(void 0===result)continue;if(null===result||"object"!=typeof result)throw new TypeError("Object expected");(_=accept(result.get))&&(descriptor.get=_),(_=accept(result.set))&&(descriptor.set=_),(_=accept(result.init))&&initializers.unshift(_)}else(_=accept(result))&&("field"===kind?initializers.unshift(_):descriptor[key]=_)}target&&Object.defineProperty(target,contextIn.name,descriptor),done=!0};import{__scopeStringToIso}from"./ScopeHelper.js";import{ChartType,MouseMode}from"./Types.js";let ServerSymbols=(()=>{var _a;let ___uploadCallback_decorators,_instanceExtraInitializers=[];return class ServerSymbols{static{const _metadata="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;___uploadCallback_decorators=[(_a=TcHmi).CallbackMethod.bind(_a)],__esDecorate(this,null,___uploadCallback_decorators,{kind:"method",name:"__uploadCallback",static:!1,private:!1,access:{has:obj=>"__uploadCallback"in obj,get:obj=>obj.__uploadCallback},metadata:_metadata},null,_instanceExtraInitializers),_metadata&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:_metadata})}static#tchmiFQN="TcHmi.Controls.Beckhoff.TcHmiScopeControl."+this.name;constructor(scopeControl){this.__parentControl=scopeControl}__parentControl=__runInitializers(this,_instanceExtraInitializers);__fileUploader=null;setChartSize(setLoadingSpinner){let width=this.__parentControl.__elementChartings.innerWidth(),height=this.__parentControl.__elementChartings.innerHeight(),scopeConfig=this.__parentControl.__scopeConfig;this.__parentControl.__scopeConfigToFile&&(scopeConfig=this.__parentControl.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".SetChartSize",writeValue:{controlName:this.__parentControl.getId(),scopeConfig,chartWidth:width,chartHeight:height}}]};this.__parentControl.__loadingSpinner&&setLoadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,ChartType.YT),TcHmi.Server.releaseRequest(this.__parentControl.__requestIds.setChartSize),this.__parentControl.__scopeConfigToFile?this.__parentControl.__requestIds.setChartSize=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback):this.__parentControl.__requestIds.setChartSize=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__setChartSizeCallback)}startRecord(recordTime){if(this.__parentControl.__scopeConfigToFile)return;let writeValue;writeValue=recordTime?{controlName:this.__parentControl.getId(),scopeConfig:this.__parentControl.__scopeConfig,recordTime}:{controlName:this.__parentControl.getId(),scopeConfig:this.__parentControl.__scopeConfig};let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".StartRecord",writeValue}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,ChartType.YT),TcHmi.Server.releaseRequest(this.__parentControl.__requestIds.startRecord),this.__parentControl.__requestIds.startRecord=TcHmi.Server.requestEx(request,{timeout:1e4},this.__parentControl.__getDataCallback)}stopRecord(){if(this.__parentControl.__scopeConfigToFile)return;let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".StopRecord",writeValue:{controlName:this.__parentControl.getId(),scopeConfig:this.__parentControl.__scopeConfig}}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,ChartType.YT),TcHmi.Server.releaseRequest(this.__parentControl.__requestIds.stopRecord),this.__parentControl.__requestIds.stopRecord=TcHmi.Server.requestEx(request,{timeout:1e4},this.__parentControl.__getDataCallback)}startDisplay(){if(this.__parentControl.__scopeConfigToFile)return;let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".StartDisplay",writeValue:{controlName:this.__parentControl.getId(),scopeConfig:this.__parentControl.__scopeConfig}}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,ChartType.YT),TcHmi.Server.releaseRequest(this.__parentControl.__requestIds.start),this.__parentControl.__requestIds.start=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback)}stopDisplay(){if(this.__parentControl.__scopeConfigToFile)return;let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".StopDisplay",writeValue:{controlName:this.__parentControl.getId(),scopeConfig:this.__parentControl.__scopeConfig}}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,ChartType.YT),TcHmi.Server.releaseRequest(this.__parentControl.__requestIds.stop),this.__parentControl.__requestIds.stop=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback)}__getDataAsRequest(){let writeValueData={controlName:this.__parentControl.getId(),scopeConfig:this.__parentControl.__scopeConfigToFile},request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".GetLayout",writeValue:writeValueData},{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".GetWindow",writeValue:writeValueData},{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".GetData",writeValue:writeValueData},{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".GetTriggerWindow",writeValue:writeValueData}]};TcHmi.Server.releaseRequest(this.__parentControl.__requestIds.getData),this.__parentControl.__requestIds.getData=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback)}setDisplayWidth(displayWidth){if(!/^[0-9],[0-9]{2}:[0-9]{2}:[0-9]{2},[0-9]{3}:[0-9]{3}?$/.test(displayWidth))return void TcHmi.Log.Controls.error(this.__parentControl,ServerSymbols.#tchmiFQN,'Wrong format for the argument "displayWidth". Example: "0,00:00:00,000:000"');let scopeConfig=this.__parentControl.__scopeConfig;this.__parentControl.__scopeConfigToFile&&(scopeConfig=this.__parentControl.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".SetDisplayWidth",writeValue:{controlName:this.__parentControl.getId(),scopeConfig,displayWidth:__scopeStringToIso(displayWidth)}}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,ChartType.YT),this.__parentControl.__displayWidthText=displayWidth,TcHmi.Server.releaseRequest(this.__parentControl.__requestIds.displayWidth),this.__parentControl.__requestIds.displayWidth=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback)}scroll(direction){let scopeConfig=this.__parentControl.__scopeConfig;this.__parentControl.__scopeConfigToFile&&(scopeConfig=this.__parentControl.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".Scroll",writeValue:{controlName:this.__parentControl.getId(),scopeConfig,direction}}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,ChartType.YT),TcHmi.Server.releaseRequest(this.__parentControl.__requestIds.scroll),this.__parentControl.__requestIds.scroll=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback)}scrollBig(direction){let scopeConfig=this.__parentControl.__scopeConfig;this.__parentControl.__scopeConfigToFile&&(scopeConfig=this.__parentControl.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".ScrollBig",writeValue:{controlName:this.__parentControl.getId(),scopeConfig,direction}}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,ChartType.YT),TcHmi.Server.releaseRequest(this.__parentControl.__requestIds.scrollBig),this.__parentControl.__requestIds.scrollBig=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback)}goTo(goTo){if(!/^[0-9],[0-9]{2}:[0-9]{2}:[0-9]{2},[0-9]{3}:[0-9]{3}?$/.test(goTo))return void TcHmi.Log.Controls.error(this.__parentControl,ServerSymbols.#tchmiFQN,'Wrong format for the argument "goTo". Example: "0,00:00:00,000:000"');let scopeConfig=this.__parentControl.__scopeConfig;this.__parentControl.__scopeConfigToFile&&(scopeConfig=this.__parentControl.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".Goto",writeValue:{controlName:this.__parentControl.getId(),scopeConfig,position:__scopeStringToIso(goTo)}}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,ChartType.YT),this.__parentControl.__gotoText=goTo,TcHmi.Server.releaseRequest(this.__parentControl.__requestIds.goto),this.__parentControl.__requestIds.goto=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback)}undo(){let scopeConfig=this.__parentControl.__scopeConfig;this.__parentControl.__scopeConfigToFile&&(scopeConfig=this.__parentControl.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".Undo",writeValue:{controlName:this.__parentControl.getId(),scopeConfig}}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,ChartType.YT),TcHmi.Server.releaseRequest(this.__parentControl.__requestIds.undo),this.__parentControl.__requestIds.undo=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback)}redo(){let scopeConfig=this.__parentControl.__scopeConfig;this.__parentControl.__scopeConfigToFile&&(scopeConfig=this.__parentControl.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".Redo",writeValue:{controlName:this.__parentControl.getId(),scopeConfig}}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,ChartType.YT),TcHmi.Server.releaseRequest(this.__parentControl.__requestIds.redo),this.__parentControl.__requestIds.redo=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback)}zoomToDefault(){let scopeConfig=this.__parentControl.__scopeConfig;this.__parentControl.__scopeConfigToFile&&(scopeConfig=this.__parentControl.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".ZoomToDefault",writeValue:{controlName:this.__parentControl.getId(),scopeConfig}}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,ChartType.YT),TcHmi.Server.releaseRequest(this.__parentControl.__requestIds.unzoom),this.__parentControl.__requestIds.unzoom=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback)}zoomOutMax(){let scopeConfig=this.__parentControl.__scopeConfig;this.__parentControl.__scopeConfigToFile&&(scopeConfig=this.__parentControl.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".ZoomOutMax",writeValue:{controlName:this.__parentControl.getId(),scopeConfig}}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,ChartType.YT),TcHmi.Server.releaseRequest(this.__parentControl.__requestIds.zoomOut),this.__parentControl.__requestIds.zoomOut=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback)}setOverviewMode(){let scopeConfig=this.__parentControl.__scopeConfig;this.__parentControl.__scopeConfigToFile&&(scopeConfig=this.__parentControl.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".SetOverviewMode",writeValue:{controlName:this.__parentControl.getId(),scopeConfig,showOverview:!this.__parentControl.__showOverview}}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,ChartType.YT),TcHmi.Server.releaseRequest(this.__parentControl.__requestIds.setOverviewMode),this.__parentControl.__requestIds.setOverviewMode=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback)}setMouseMode(valueNew){let convertedValue=TcHmi.ValueConverter.toEnum(valueNew,MouseMode);if(!tchmi_equal(convertedValue,this.__parentControl.__mouseMode))if(TcHmi.EventProvider.raise(this.__parentControl.getId()+".onPropertyChanged",{propertyName:"MouseMode"}),this.__parentControl.__scopeLayout)if(convertedValue===MouseMode.PanX)this.__parentControl.__toolBarControls.PanToggleButton&&(this.__parentControl.__toolBarControls.PanToggleButton.setToggleState("Active"),this.__parentControl.__mouseMode=MouseMode.PanX);else if(convertedValue===MouseMode.PanY)this.__parentControl.__toolBarControls.PanYToggleButton&&(this.__parentControl.__toolBarControls.PanYToggleButton.setToggleState("Active"),this.__parentControl.__mouseMode=MouseMode.PanY);else if(convertedValue===MouseMode.PanXY)this.__parentControl.__toolBarControls.PanXYToggleButton&&(this.__parentControl.__toolBarControls.PanXYToggleButton.setToggleState("Active"),this.__parentControl.__mouseMode=MouseMode.PanXY);else if(convertedValue===MouseMode.ZoomX)this.__parentControl.__toolBarControls.ZoomToggleButton&&(this.__parentControl.__toolBarControls.ZoomToggleButton.setToggleState("Active"),this.__parentControl.__mouseMode=MouseMode.ZoomX);else if(convertedValue===MouseMode.ZoomY)this.__parentControl.__toolBarControls.ZoomYToggleButton&&(this.__parentControl.__toolBarControls.ZoomYToggleButton.setToggleState("Active"),this.__parentControl.__mouseMode=MouseMode.ZoomY);else if(convertedValue===MouseMode.ZoomXY)this.__parentControl.__toolBarControls.ZoomXYToggleButton&&(this.__parentControl.__toolBarControls.ZoomXYToggleButton.setToggleState("Active"),this.__parentControl.__mouseMode=MouseMode.ZoomXY);else{for(let controlName in this.__parentControl.__toolBarControls)controlName.includes("ToggleButton")&&this.__parentControl.__toolBarControls[controlName].setToggleState("Normal");switch(ChartType[this.__parentControl.__scopeLayout.chartType]){case ChartType.SingleBarChart:this.__parentControl.__toolBarControls.PanYToggleButton&&(this.__parentControl.__toolBarControls.PanYToggleButton.setToggleState("Active"),this.__parentControl.__mouseMode=MouseMode.PanY);break;case ChartType.YT:case ChartType.XY:case ChartType.ArrayBarChart:default:this.__parentControl.__toolBarControls.PanXYToggleButton&&(this.__parentControl.__toolBarControls.PanXYToggleButton.setToggleState("Active"),this.__parentControl.__mouseMode=MouseMode.PanXY)}}else this.__parentControl.__mouseMode=MouseMode.None}changeChannelState(id,state){let scopeConfig=this.__parentControl.__scopeConfig;this.__parentControl.__scopeConfigToFile&&(scopeConfig=this.__parentControl.__scopeConfigToFile);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".ChangeChannelState",writeValue:{controlName:this.__parentControl.getId(),scopeConfig,channelId:id,newState:state}}]};this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner),this.__parentControl.__enableOrDisableMenuControls("Disable",!1,!1,!1,ChartType.YT),TcHmi.Server.releaseRequest(this.__parentControl.__requestIds.changeChannelState),this.__parentControl.__requestIds.changeChannelState=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback)}__downloadScopeRecord(element=null){if(element){let downloaderAElement=document.createElement("a");downloaderAElement.href=tchmi_path(TcHmi.Environment.getHostBaseUri()+"/Config/ExtensionData/"+this.__parentControl.__serverDomain+"?extensionName="+element.extensionName+"&userName="+element.userName+"&fileName="+element.fileName),downloaderAElement.style.display="none",downloaderAElement.download="ScopeRecord.svdx",document.body.appendChild(downloaderAElement),downloaderAElement.click(),document.body.removeChild(downloaderAElement)}else if(this.__parentControl.__scopeConfig){let downloaderAElement=document.createElement("a");downloaderAElement.href=tchmi_path(TcHmi.Environment.getHostBaseUri()+"/Config/ExtensionData/"+this.__parentControl.__serverDomain+"?configName="+this.__parentControl.__scopeConfig.name),downloaderAElement.style.display="none",downloaderAElement.download="ScopeRecord.svdx",document.body.appendChild(downloaderAElement),downloaderAElement.click(),document.body.removeChild(downloaderAElement)}else TcHmi.Log.Controls.error(this.__parentControl,ServerSymbols.#tchmiFQN,"ScopeConfig has not been defined.")}uploadRecord(file,persist,chunkSize){if(this.__parentControl.__dialog){this.__parentControl.__dialog.setIsWaitingForServer(!0),this.__parentControl.__dialog.disableAllButtons();let allChunks=Math.ceil(file.size/chunkSize);this.__parentControl.__dialog.setProgressbarMaxValue(allChunks)}this.__fileUploader??=new TcHmi.FileUploader({domain:this.__parentControl.__serverDomain}),this.__fileUploader.chunkSize=chunkSize;let blob=file.slice(0,file.size);this.__fileUploader?.queue(file.name,blob,{progressCallback:this.__uploadCallback,additionalProperties:{fileSize:file.size,persist}})}__uploadCallback(result){if(!this.__parentControl.getIsDestroyed())if(result&&result.error===TcHmi.Errors.NONE){if(result.status===TcHmi.FileUploader.FileStatus.Finished)this.__parentControl.__dialog&&(this.__parentControl.__dialog.setIsWaitingForServer(!1),this.__parentControl.__dialog.enableAllButtons());else if(this.__parentControl.__dialog){let value=this.__parentControl.__dialog.getProgressbarValue();this.__parentControl.__dialog.setProgressbarValue(value+1)}}else if(result.error){if(result.details.errors)for(let i=0,ii=result.details.errors.length;i<ii;i++)if(result.details.errors[i].code){if(TcHmi.Log.Controls.error(this.__parentControl,ServerSymbols.#tchmiFQN,`Server responds with error for command for symbol 'Upload'. Details: ${TcHmi.Log.buildMessage(result.details.errors[i])}`),result.details.errors[i].code){const errorMessage=result.details.errors[i].reason??result.details.errors[i].message??result.details.errors[i].code?.toString()??"";this.__parentControl.__dialog&&(this.__parentControl.__createErrorDialog("%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Popup_Text_Upload%/l%",errorMessage),this.__parentControl.__dialog.setIsWaitingForServer(!1),this.__parentControl.__dialog.enableAllButtons())}return}TcHmi.Log.Controls.error(this.__parentControl,ServerSymbols.#tchmiFQN,`Framework error=${result.error}, name=${TcHmi.Errors[result.error]} while fetching data from server.`)}}async saveCurrentRecord(){if(this.__parentControl.__scopeConfig){let replace=!1;if(void 0===this.__parentControl.__replace){if(this.__parentControl.__uploadedRecordsForActUser){let userInfos=TcHmi.Server.getCurrentUserConfig(),filteredElements=this.__parentControl.__uploadedRecordsForActUser.filter(x=>x.userName===userInfos.name&&x.extensionName===userInfos.defaultAuthExtension&&x.fileName.includes(this.__parentControl.__scopeConfig?.name));if(this.__parentControl.__dialog&&filteredElements&&filteredElements.length>0){let promise=await this.__parentControl.__dialog.replaceOrIncrementCurrentRecord();if("cancel"===promise.result)return;"replace"===promise.result&&(replace=!0),promise.saveResult&&(this.__parentControl.__replace=replace,this.__parentControl.__storage?.set("replace",this.__parentControl.__replace))}}}else replace=this.__parentControl.__replace;let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".SaveCurrentRecord",writeValue:{scopeConfigName:this.__parentControl.__scopeConfig.name,persist:!0,replace}}]};this.__parentControl.__dialog&&(this.__parentControl.__dialog.setIsWaitingForServer(!0),this.__parentControl.__dialog.disableAllButtons()),TcHmi.Server.releaseRequest(this.__parentControl.__requestIds.saveCurrentRecord),this.__parentControl.__requestIds.saveCurrentRecord=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback)}}deleteScopeUpload(elements){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".DeleteScopeRecord",writeValue:elements}]};this.__parentControl.__dialog&&(this.__parentControl.__dialog.setIsWaitingForServer(!0),this.__parentControl.__dialog.disableAllButtons()),TcHmi.Server.releaseRequest(this.__parentControl.__requestIds.deleteScopeRecord),this.__parentControl.__requestIds.deleteScopeRecord=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback)}changePersist(element){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".ChangePersist",writeValue:element}]};TcHmi.Server.releaseRequest(this.__parentControl.__requestIds.changePersist),this.__parentControl.__requestIds.changePersist=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback)}getChartList(element){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".GetChartList",writeValue:element}]};TcHmi.Server.releaseRequest(this.__parentControl.__requestIds.getChartList),this.__parentControl.__requestIds.getChartList=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback)}download(element){this.__downloadScopeRecord(element)}openConnectionToFile(element){if(null===this.__parentControl.__requestIds.openConnection){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:this.__parentControl.__serverDomain+".OpenConnectionToFile",writeValue:{controlName:this.__parentControl.getId(),uploadFileInformation:element}}]};TcHmi.Server.releaseRequest(this.__parentControl.__requestIds.openConnectionToFile),this.__parentControl.__requestIds.openConnectionToFile=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback)}else this.__parentControl.__dialog&&(this.__parentControl.__createErrorDialog("%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Popup_Text_OpenConnectionNotReady%/l%"),this.__parentControl.__dialog.closeChartsDialog())}detachFromScopeRecord(){if(this.__parentControl.__scopeConfigToFile){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".CloseConnection",writeValue:{controlName:this.__parentControl.getId(),scopeConfig:this.__parentControl.__scopeConfigToFile}}]};TcHmi.Server.releaseRequest(this.__parentControl.__requestIds.closeConnection),this.__parentControl.__requestIds.closeConnection=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback)}}closeConnection(scopeConfig){if(scopeConfig){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".CloseConnection",writeValue:{controlName:this.__parentControl.getId(),scopeConfig}}]};TcHmi.Server.releaseRequest(this.__parentControl.__requestIds.closeConnection),this.__parentControl.__requestIds.closeConnection=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback)}}getAnalyticsData(){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".GetAnalyticsData",writeValue:{controlName:this.__parentControl.getId(),scopeConfig:null!==this.__parentControl.__scopeConfigToFile?this.__parentControl.__scopeConfigToFile:this.__parentControl.__scopeConfig}}]};TcHmi.Server.releaseRequest(this.__parentControl.__requestIds.getAnalyticsData),this.__parentControl.__requestIds.getAnalyticsData=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback)}setAnalyticsRecord(recordName,recordId,startTime,endTime){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__parentControl.__serverDomain+".SetAnalyticsRecord",writeValue:{controlName:this.__parentControl.getId(),scopeConfig:null!==this.__parentControl.__scopeConfigToFile?this.__parentControl.__scopeConfigToFile:this.__parentControl.__scopeConfig,recordName,recordId,startTime,endTime}}]};TcHmi.Server.releaseRequest(this.__parentControl.__requestIds.setAnalyticsRecord),this.__parentControl.__requestIds.setAnalyticsRecord=TcHmi.Server.requestEx(request,{parallel:!0},this.__parentControl.__getDataCallback),this.__parentControl.__loadingSpinner&&this.__parentControl.__elementLoading[0].appendChild(this.__parentControl.__loadingSpinner)}}})();export{ServerSymbols};